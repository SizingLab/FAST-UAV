title: Multirotor Drone model with catalogue components selection and consistency constraints solving

# List of folder paths where user added custom registered OpenMDAO components
module_folders: 
    - ../models
    - ../models/Missions
    - ../models/Scenarios
    - ../models/System
    - ../models/Components/Energy/Battery
    - ../models/Components/ESC
    - ../models/Components/Motor
    - ../models/Components/Propeller
    - ../models/Components/Structure
    - ../models/Components/Cables
    
# Input and output files
input_file: ../workdir/model_inputs.xml
output_file: ../workdir/model_outputs.xml

# Definition of problem driver assuming the OpenMDAO convention import openmdao.api as om
driver: om.ScipyOptimizeDriver(tol=1e-3, optimizer='SLSQP')

# Definition of OpenMDAO model
model:
    Core:
        scenarios:
            id: multirotor.sizing_scenarios
        propeller:
            id: propeller
            use_catalogue: true
        motor:
            id: motor
            use_catalogue: false
            use_gearbox: false
        battery:
            id: energy.battery
            use_catalogue: false
        esc:
            id: esc
            use_catalogue: false
        structure:
            id: multirotor.structure
        cables:
            id: cables
        system:
            id: multirotor.system
        missions:
            design_mission:
                id: multirotor.design_mission


optimization:
    design_variables:
      - name: data:system:settings:MTOW:k # over estimation coefficient on the mass (to solve the mass consistency constraint)
        upper: 40.0
        lower: 1.0
        
      #- name: data:motor:settings:speed:k # over estimation coefficient on the motor speed (to solve the battery voltage consistency)
      #  lower: 1.0
      #  upper: 10.0

    constraints:
      - name: data:system:constraints:mass:convergence  # consistency constraint on the drone mass
        lower: 0.0
        
      #- name: data:battery:constraints:voltage:takeoff
      #  lower: 0.0
        
      
    objective:
      # MASS MINIMIZATION
      - name: data:system:MTOW
        scaler: 1e-1

      # ENERGY MINIMIZATION
      #- name: mission:design_mission:energy
      #  scaler: 1e-3
        
      # MAX. RANGE MAXIMIZATION
      #- name: mission:design_mission:forward:distance:max
      #  scaler: -1e-3

      # HOVER AUTONOMY MAXIMIZATION
      #- name: mission:design_mission:hover:duration:max
      #  scaler: -1e-1